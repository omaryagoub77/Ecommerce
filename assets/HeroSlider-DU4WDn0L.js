import{d as e,j as s}from"./index-DgyEPu9Q.js";import{r as t,W as l,j as n,k as a}from"./ui-DPpDBAq4.js";import{q as i,k as r,f as o,n as c}from"./firebase-DjIx1_qE.js";import{u as d}from"./utils-D-lYNrO5.js";import"./vendor-d2XN-_nt.js";import"./router-Bw3HBEct.js";const u=t.memo(({slide:e,isActive:t,isEager:l,scrollToMenSection:n})=>s.jsxs("div",{className:"slide","aria-hidden":!t,children:[s.jsx("img",{src:e.image,alt:e.title||"Slide",className:"slide-image",loading:l?"eager":"lazy"}),s.jsx("div",{className:"slide-overlay",children:s.jsxs("div",{className:"slide-content",children:[s.jsx("h2",{className:"slide-title",children:e.title}),e.description&&s.jsx("p",{className:"slide-description",children:e.description}),e.buttonText&&s.jsx("button",{className:"slide-subtitle hero-btn",onClick:n,children:e.buttonText})]})})]})),h=t.memo(()=>{const[h,m]=t.useState([]),[g,v]=t.useState(1),[x,j]=t.useState(!0),[b,f]=t.useState(!0),[N,p]=t.useState(null),[k,E]=t.useState(!1),w=t.useRef(null),C=t.useRef(new Set),y=t.useRef(null);t.useEffect(()=>{f(!0),p(null);const s=i(o(e,"heroes"),r("createdAt","desc")),t=c(s,e=>{const s=e.docs.map(e=>({id:e.id,...e.data()}));m(s),f(!1)},e=>{p("Failed to load slides. Please try again."),f(!1)});return()=>t()},[]),t.useEffect(()=>{const e=()=>{E("ontouchstart"in window||navigator.maxTouchPoints>0||window.matchMedia("(pointer: coarse)").matches)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const S=t.useCallback(()=>{w.current&&clearInterval(w.current),w.current=setInterval(()=>{v(e=>e>=h.length+1?1:e+1)},5e3)},[h.length]),T=t.useCallback(()=>{w.current&&(clearInterval(w.current),w.current=null)},[]),z=t.useCallback(()=>{T(),S()},[S,T]),I=t.useCallback(()=>{T()},[T]),L=t.useCallback(()=>{S()},[S]);t.useEffect(()=>(h.length>0&&S(),()=>T()),[h.length,S,T]),t.useEffect(()=>{const e=()=>{document.hidden?T():h.length>0&&S()};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[h.length,S,T]);const A=t.useCallback(()=>{v(e=>e>=h.length+1?1:e+1)},[h.length]),M=t.useCallback(()=>{v(e=>e<=0?h.length:e-1)},[h.length]),R=t.useCallback(()=>{g===h.length+1?requestAnimationFrame(()=>{j(!1),v(1)}):0===g&&requestAnimationFrame(()=>{j(!1),v(h.length)})},[g,h.length]);t.useEffect(()=>{if(!x){const e=setTimeout(()=>j(!0),50);return()=>clearTimeout(e)}},[x]);const $=t.useCallback(e=>{v(e+1),z()},[z]),q=t.useCallback(()=>{const e=document.getElementById("men-section");e&&e.scrollIntoView({behavior:"smooth"})},[]);t.useEffect(()=>{0!==h.length&&[g-1,g,g+1].map(e=>{const s=(e%h.length+h.length)%h.length;return h[s]?.image}).filter(Boolean).forEach(e=>{e&&!C.current.has(e)&&((new Image).src=e,C.current.add(e))})},[g,h]);const F=d({onDragEnd:({swipe:[e]})=>{-1===e?(A(),z()):1===e&&(M(),z())}},{enabled:k,drag:{threshold:30,axis:"x",swipe:{velocity:.3,distance:50}}}),P=h.length>0?[h[h.length-1],...h,h[0]]:[];return b?s.jsx("div",{className:"hero-slider",children:s.jsxs("div",{className:"slider-loading",children:[s.jsx("div",{className:"loading-skeleton"}),s.jsx("div",{className:"loading-text",children:"Loading slides..."})]})}):N?s.jsx("div",{className:"hero-slider",children:s.jsxs("div",{className:"slider-error",children:[s.jsx(l,{size:48}),s.jsx("p",{children:N}),s.jsx("button",{className:"retry-button",onClick:()=>window.location.reload(),children:"Retry"})]})}):h.length?s.jsxs("div",{...F(),className:"hero-slider",role:"region","aria-label":"Hero Image Slider","aria-live":"polite",ref:y,onMouseEnter:I,onMouseLeave:L,children:[s.jsx("div",{className:"slides-container "+(x?"":"no-transition"),style:{transform:`translateX(-${100*g}%)`},onTransitionEnd:R,children:P.map((e,t)=>{const l=t<=2||t===P.length-1,n=t===g;return s.jsx(u,{slide:e,isActive:n,isEager:l,scrollToMenSection:q},`${e.id}-${t}`)})}),s.jsx("button",{className:"nav-btn nav-btn--left",onClick:()=>{M(),z()},"aria-label":"Previous slide",children:s.jsx(n,{size:24})}),s.jsx("button",{className:"nav-btn nav-btn--right",onClick:()=>{A(),z()},"aria-label":"Next slide",children:s.jsx(a,{size:24})}),s.jsx("div",{className:"slide-indicators",children:h.map((e,t)=>s.jsx("button",{className:"indicator "+((g-1+h.length)%h.length===t?"indicator--active":""),onClick:()=>$(t),"aria-label":`Go to slide ${t+1}`},t))})]}):s.jsx("div",{className:"hero-slider",children:s.jsxs("div",{className:"slider-empty",children:[s.jsx(l,{size:48}),s.jsx("p",{children:"No slides available"})]})})});export{h as default};
