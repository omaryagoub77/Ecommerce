import{d as e,j as s}from"./index-CbVUMqtW.js";import{r as a,W as t,R as r,H as l,S as o}from"./ui-JvLBDIZS.js";import{f as d,q as i,w as c,h as n,l as m,j as x}from"./firebase-BxPAW4b_.js";import{L as h}from"./router-z7kgPuEy.js";import"./vendor-d2XN-_nt.js";const g={products:[],loading:!1,favoriteState:[],lastVisible:null,hasMore:!0,page:1};function u(e,s){switch(s.type){case"SET_PRODUCTS":return{...e,products:s.payload};case"SET_LOADING":return{...e,loading:s.payload};case"SET_FAVORITE_STATE":return{...e,favoriteState:Array.isArray(s.payload)?s.payload:[]};case"SET_LAST_VISIBLE":return{...e,lastVisible:s.payload};case"SET_HAS_MORE":return{...e,hasMore:s.payload};case"SET_PAGE":return{...e,page:s.payload};case"RESET_PAGINATION":return{...e,page:1,lastVisible:null,hasMore:!0,products:[]};default:return e}}const p=r.memo(({product:e,onAddToCart:t,onAddToFavorites:r,isFav:d})=>{const[i,c]=a.useState(!1),[n,m]=a.useState(!1),x=parseFloat(e.price)||0,g=parseFloat(e.newprice||e.newPrice)||x,u=x>g?Math.round((x-g)/x*100):0,p=e.images&&e.images.length>0?e.images[0]:null;return s.jsxs("div",{className:"group bg-white rounded-xl shadow-sm overflow-hidden transition-shadow duration-300 hover:shadow-xl border border-gray-100 flex flex-col h-[90%]",children:[s.jsxs("div",{className:"relative overflow-hidden bg-gray-50 aspect-square",children:[s.jsx(h,{to:`/product/${e.id}`,"aria-label":`View details for ${e.name}`,children:p?s.jsx("img",{src:p,alt:e.name,className:"w-full h-full object-cover transition-all duration-300 group-hover:scale-110 "+(i?"opacity-100":"opacity-0"),onLoad:()=>c(!0),onError:()=>m(!0)}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:s.jsx("span",{className:"text-gray-400 text-sm",children:"No Image"})})}),u>0&&s.jsxs("div",{className:"absolute top-3 left-3 bg-red-600 text-white px-3 py-1 rounded-full text-xs font-bold shadow-lg",children:[u,"% OFF"]}),s.jsx("button",{onClick:()=>r(e.id),"aria-label":d?"Remove from favorites":"Add to favorites",className:"absolute top-3 right-3 p-2 rounded-full backdrop-blur-sm transition-all duration-300 shadow-lg "+(d?"bg-red-600 text-white":"bg-white/90 text-gray-600 hover:bg-red-50 hover:text-red-600"),children:s.jsx(l,{className:"w-4 h-4 transition-all duration-200 "+(d?"fill-current":"")})}),!i&&!n&&p&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 animate-pulse",children:s.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full"})})]}),s.jsxs("div",{className:"p-3 flex flex-col flex-grow",children:[s.jsx("h3",{className:"font-semibold text-gray-900 line mb-2 text-sm sm:text-base min-h-[2.5rem]",children:e.name}),s.jsxs("div",{className:"flex items-center justify-between mt-auto pt-3 border-t border-gray-100",children:[s.jsxs("div",{className:"flex flex-col",children:[x>g&&s.jsxs("span",{className:"line-through text-xs text-gray-400",children:["$",x.toFixed(2)]}),s.jsxs("span",{className:"text-lg font-bold text-red-600",children:["$",g.toFixed(2)]})]}),s.jsxs("button",{onClick:()=>t(e),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all shadow-md hover:shadow-lg text-sm font-medium flex items-center space-x-1","aria-label":`Add ${e.name} to cart`,children:[s.jsx(o,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Add"})]})]})]})]})},(e,s)=>e.product.id===s.product.id&&e.isFav===s.isFav),y=()=>s.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden animate-pulse border border-gray-100 flex flex-col h-[90%]",children:[s.jsxs("div",{className:"relative overflow-hidden bg-gray-200 aspect-square",children:[s.jsx("div",{className:"absolute top-3 left-3 bg-gray-300 rounded-full px-3 py-1 w-12 h-6"}),s.jsx("div",{className:"absolute top-3 right-3 flex flex-col space-y-2 z-10",children:s.jsx("div",{className:"p-2 rounded-full bg-gray-300 w-8 h-8"})})]}),s.jsxs("div",{className:"p-3 flex flex-col flex-grow",children:[s.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),s.jsxs("div",{className:"flex items-center justify-between mt-auto pt-3 border-t border-gray-200",children:[s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("div",{className:"h-3 bg-gray-300 rounded w-8"}),s.jsx("div",{className:"h-5 bg-gray-300 rounded w-14"})]}),s.jsx("div",{className:"px-4 py-2 bg-gray-300 rounded-lg w-16 h-9"})]})]})]}),f=r.memo(({title:e,count:a})=>s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:e}),s.jsxs("span",{className:"bg-red-100 text-red-800 text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full",children:[a," ",1===a?"item":"items"]})]})),b=({onAddToCart:r,searchQuery:l})=>{const[o,b]=a.useReducer(u,g),{products:j,loading:v,favoriteState:N,lastVisible:w,hasMore:A,page:S}=o;a.useEffect(()=>{const e=(()=>{try{const e=localStorage.getItem("favorites");if(!e)return[];const s=JSON.parse(e);return Array.isArray(s)?s:[]}catch(e){return[]}})();b({type:"SET_FAVORITE_STATE",payload:e})},[]);const T=a.useCallback(async(s=1)=>{1===s&&(b({type:"SET_LOADING",payload:!0}),b({type:"RESET_PAGINATION"}));try{let a=d(e,"products");a=i(a,c("category","==","men")),l&&""!==l.trim()&&(a=i(a,c("name",">=",l),c("name","<=",l+"ï£¿"))),a=s>1&&w?i(a,n(w),m(12)):i(a,m(12));const t=await x(a),r=t.docs.map(e=>({id:e.id,...e.data()}));b(1===s?{type:"SET_PRODUCTS",payload:r}:{type:"SET_PRODUCTS",payload:[...j,...r]}),b({type:"SET_LAST_VISIBLE",payload:t.docs[t.docs.length-1]}),b({type:"SET_HAS_MORE",payload:12===t.docs.length}),b({type:"SET_PAGE",payload:s})}catch(a){}finally{b({type:"SET_LOADING",payload:!1})}},[l,w,j,12]);a.useEffect(()=>{T()},[]),a.useEffect(()=>{l&&T(1)},[l]);const E=a.useCallback(e=>{const s=Array.isArray(N)?[...N]:"object"==typeof N&&null!==N?Object.values(N):[];let a;a=s.includes(e)?s.filter(s=>s!==e):[...s,e],(e=>{try{const s=Array.isArray(e)?e:[];localStorage.setItem("favorites",JSON.stringify(s))}catch(s){}})(a),b({type:"SET_FAVORITE_STATE",payload:a})},[N]),_=Array.isArray(N)?N:"object"==typeof N&&null!==N?Object.values(N):[],C=a.useCallback(()=>{!v&&A&&T(S+1)},[v,A,S,T]);return v&&0===j.length?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Men's Collection"}),s.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto text-sm",children:"Discover our latest collection of premium products"})]}),s.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 bg-gray-50",children:Array.from({length:4}).map((e,a)=>s.jsx(y,{},a))})]})}):0===j.length?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-6 bg-white rounded-2xl shadow-xl",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(t,{className:"w-6 h-6 sm:w-8 sm:h-8 text-red-600"})}),s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-3",children:"No Products Available"}),s.jsx("p",{className:"text-gray-600 mb-6 text-sm",children:"We couldn't find any products at the moment. Please check back later."}),s.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Refresh Page"})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx(f,{title:"Men's Collection",count:j.length}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Browse our premium selection of men's products"})]}),s.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 grid-col-2 bg-gray-50",children:j.map(e=>s.jsx(p,{product:e,onAddToCart:r,onAddToFavorites:E,isFav:_.includes(e.id)},e.id))}),A&&s.jsx("div",{className:"flex justify-center my-8",children:s.jsx("button",{onClick:C,disabled:v,className:"px-6 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all duration-300 shadow-md hover:shadow-lg flex items-center disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:v?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):"Load More Products"})}),s.jsx("div",{className:"mt-12 text-center",children:s.jsx(h,{to:"/",className:"inline-flex items-center px-6 py-3 bg-gray-100 text-gray-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors",children:"Continue Shopping"})})]})})};export{b as default};
