import{d as e,j as s}from"./index-CmWDTdfw.js";import{r as a,h as t,R as r,H as l,S as d}from"./ui-JvLBDIZS.js";import{f as o,q as i,w as c,j as n,l as m,h as x}from"./firebase-B8p-dfjM.js";import{L as p}from"./router-z7kgPuEy.js";import"./vendor-d2XN-_nt.js";const h={products:[],loading:!1,favoriteState:[],lastVisible:null,hasMore:!0,page:1};function g(e,s){switch(s.type){case"SET_PRODUCTS":return{...e,products:s.payload};case"SET_LOADING":return{...e,loading:s.payload};case"SET_FAVORITE_STATE":return{...e,favoriteState:Array.isArray(s.payload)?s.payload:[]};case"SET_LAST_VISIBLE":return{...e,lastVisible:s.payload};case"SET_HAS_MORE":return{...e,hasMore:s.payload};case"SET_PAGE":return{...e,page:s.payload};case"RESET_PAGINATION":return{...e,page:1,lastVisible:null,hasMore:!0,products:[]};default:return e}}const u=r.memo(({product:e,onAddToCart:a,onAddToFavorites:t,isFav:r})=>{const o=parseFloat(e.price)||0,i=parseFloat(e.newPrice||e.newprice)||o,c=e.images&&e.images.length>0?e.images[0]:null;return s.jsxs("div",{className:"group bg-white rounded-lg shadow-sm overflow-hidden transition-all duration-300 hover:shadow-md border border-gray-100 flex flex-col h-full",children:[s.jsxs("div",{className:"relative overflow-hidden bg-gray-100 aspect-[1/1]",children:[c?s.jsx(p,{to:`/product/${e.id}`,"aria-label":`View details for ${e.name}`,children:s.jsx("img",{src:c,alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-200",children:s.jsx("div",{className:"w-16 h-16 bg-gray-300 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-gray-500 text-xs",children:"No Image"})})}),s.jsx("div",{className:"absolute top-2 right-2 flex flex-col space-y-2 z-10",children:s.jsx("button",{onClick:()=>t(e.id),"aria-label":r?"Remove from favorites":"Add to favorites",className:"p-1 sm:p-1.5 max-[450px]:p-1 rounded-full backdrop-blur-sm transition-all duration-300 shadow-sm "+(r?"bg-pink-100 text-pink-600":"bg-white/80 text-gray-600 hover:bg-pink-50 hover:text-pink-600"),children:s.jsx(l,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 max-[450px]:w-3 max-[450px]:h-3 transition-all duration-200 "+(r?"fill-current":"")})})}),o>i&&s.jsxs("div",{className:"absolute top-2 left-2 bg-red-600 text-white px-1 py-0.5 sm:px-1.5 sm:py-0.5 max-[450px]:px-1 max-[450px]:py-0.5 rounded-full text-xs font-bold shadow-md z-10",children:[Math.round((o-i)/o*100),"% OFF"]})]}),s.jsxs("div",{className:"p-2 flex flex-col flex-grow",children:[s.jsx("div",{className:"flex justify-between items-start mb-1",children:s.jsx("h3",{className:"font-bold text-sm sm:text-base text-gray-900 line-clamp-1",children:e.name})}),s.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[o>i&&s.jsxs("span",{className:"line-through text-xs text-gray-500",children:["$",o.toFixed(2)]}),s.jsxs("span",{className:"text-sm sm:text-base font-bold text-red-700",children:["$",i.toFixed(2)]})]}),s.jsx("button",{onClick:()=>a(e),className:"p-1 sm:p-1.5 max-[450px]:p-1 bg-red-700 text-white rounded-lg hover:bg-red-800 transition-colors shadow-sm","aria-label":`Add ${e.name} to cart`,children:s.jsx(d,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 max-[450px]:w-3 max-[450px]:h-3"})})]})]})]})},(e,s)=>e.product.id===s.product.id&&e.isFav===s.isFav),y=()=>s.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden animate-pulse border border-gray-100 flex flex-col h-full",children:[s.jsxs("div",{className:"relative overflow-hidden bg-gray-200 aspect-[1/1]",children:[s.jsx("div",{className:"absolute top-2 left-2 bg-gray-300 rounded-full px-1 py-0.5 sm:px-1.5 sm:py-0.5 max-[450px]:px-1 max-[450px]:py-0.5 w-12 h-4 max-[450px]:w-10 max-[450px]:h-3"}),s.jsxs("div",{className:"absolute top-2 right-2 flex flex-col space-y-2 z-10",children:[s.jsx("div",{className:"p-1 sm:p-1.5 max-[450px]:p-1 rounded-full bg-gray-300 w-6 h-6 sm:w-7 sm:h-7 max-[450px]:w-5 max-[450px]:h-5"}),s.jsx("div",{className:"p-1 sm:p-1.5 max-[450px]:p-1 rounded-full bg-gray-300 w-6 h-6 sm:w-7 sm:h-7 max-[450px]:w-5 max-[450px]:h-5"})]})]}),s.jsxs("div",{className:"p-2 flex flex-col flex-grow",children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("div",{className:"h-4 bg-gray-300 rounded w-2/3"}),s.jsx("div",{className:"h-4 bg-gray-300 rounded-full w-12"})]}),s.jsx("div",{className:"h-3 bg-gray-300 rounded w-full mb-1"}),s.jsx("div",{className:"h-3 bg-gray-300 rounded w-5/6 mb-2"}),s.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"h-3 bg-gray-300 rounded w-8"}),s.jsx("div",{className:"h-5 bg-gray-300 rounded w-14"})]}),s.jsx("div",{className:"p-1 sm:p-1.5 max-[450px]:p-1 bg-gray-300 rounded-lg w-6 h-6 sm:w-7 sm:h-7 max-[450px]:w-5 max-[450px]:h-5"})]})]})]}),f=r.memo(({title:e,count:a})=>s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:e}),s.jsxs("span",{className:"bg-red-100 text-red-800 text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full",children:[a," ",1===a?"item":"items"]})]})),b=({onAddToCart:r})=>{const[l,d]=a.useReducer(g,h),{products:b,loading:j,favoriteState:v,lastVisible:w,hasMore:N,page:A}=l;a.useEffect(()=>{const e=(()=>{try{const e=localStorage.getItem("favorites");if(!e)return[];const s=JSON.parse(e);return Array.isArray(s)?s:[]}catch(e){return[]}})();d({type:"SET_FAVORITE_STATE",payload:e})},[]);const S=a.useCallback(async(s=1)=>{1===s&&(d({type:"SET_LOADING",payload:!0}),d({type:"RESET_PAGINATION"}));try{let a=o(e,"products");a=i(a,c("category","==","kids")),a=s>1&&w?i(a,n(w),m(12)):i(a,m(12));const t=await x(a),r=t.docs.map(e=>({id:e.id,...e.data()}));d(1===s?{type:"SET_PRODUCTS",payload:r}:{type:"SET_PRODUCTS",payload:[...b,...r]}),d({type:"SET_LAST_VISIBLE",payload:t.docs[t.docs.length-1]}),d({type:"SET_HAS_MORE",payload:12===t.docs.length}),d({type:"SET_PAGE",payload:s})}catch(a){}finally{d({type:"SET_LOADING",payload:!1})}},[w,b,12]);a.useEffect(()=>{S()},[]);const T=a.useCallback(e=>{const s=Array.isArray(v)?[...v]:"object"==typeof v&&null!==v?Object.values(v):[];let a;a=s.includes(e)?s.filter(s=>s!==e):[...s,e],(e=>{try{const s=Array.isArray(e)?e:[];localStorage.setItem("favorites",JSON.stringify(s))}catch(s){}})(a),d({type:"SET_FAVORITE_STATE",payload:a})},[v]),E=Array.isArray(v)?v:"object"==typeof v&&null!==v?Object.values(v):[],_=a.useCallback(()=>{!j&&N&&S(A+1)},[j,N,A,S]);return j&&0===b.length?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Kids' Collection"}),s.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto text-sm",children:"Discover our latest collection of premium products"})]}),s.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6  sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 bg-gray-50",children:Array.from({length:4}).map((e,a)=>s.jsx(y,{},a))})]})}):0===b.length?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-6 bg-white rounded-2xl shadow-xl",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(t,{className:"w-6 h-6 sm:w-8 sm:h-8 text-red-600"})}),s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-3",children:"No Products Available"}),s.jsx("p",{className:"text-gray-600 mb-6 text-sm",children:"We couldn't find any products at the moment. Please check back later."}),s.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Refresh Page"})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx(f,{title:"Kids' Collection",count:b.length}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Browse our premium selection of kids' products"})]}),s.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6  sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 ",children:b.map(e=>s.jsx(u,{product:e,onAddToCart:r,onAddToFavorites:T,isFav:E.includes(e.id)},e.id))}),N&&s.jsx("div",{className:"flex justify-center my-8",children:s.jsx("button",{onClick:_,disabled:j,className:"px-6 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all duration-300 shadow-md hover:shadow-lg flex items-center disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:j?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):"Load More Products"})}),s.jsx("div",{className:"mt-12 text-center",children:s.jsx(p,{to:"/",className:"inline-flex items-center px-6 py-3 bg-gray-100 text-gray-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors",children:"Continue Shopping"})})]})})};export{b as default};
