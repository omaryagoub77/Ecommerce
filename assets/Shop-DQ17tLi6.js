const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./HeroSlider-Dx3JsA4_.js","./index-nyGu-4kg.js","./ui-DPpDBAq4.js","./vendor-d2XN-_nt.js","./firebase-DjIx1_qE.js","./router-Bw3HBEct.js","./index-V4KKk7xg.css","./utils-D-lYNrO5.js","./HeroSlider-D93dPRfE.css"])))=>i.map(i=>d[i]);
import{d as e,j as s,_ as a}from"./index-nyGu-4kg.js";import{R as t,r}from"./ui-DPpDBAq4.js";import{r as l}from"./utils-D-lYNrO5.js";import{f as i,q as o,w as c,h as d,l as n,j as m,k as h}from"./firebase-DjIx1_qE.js";import{L as x}from"./router-Bw3HBEct.js";import"./vendor-d2XN-_nt.js";var u=l();const p=new class{constructor(){this.cache=new Map,this.timers=new Map}set(e,s,a=3e5){this.timers.has(e)&&clearTimeout(this.timers.get(e)),this.cache.set(e,{value:s,timestamp:Date.now()});const t=setTimeout(()=>{this.delete(e)},a);this.timers.set(e,t)}get(e){const s=this.cache.get(e);return s?s.value:null}has(e){return this.cache.has(e)}delete(e){this.timers.has(e)&&(clearTimeout(this.timers.get(e)),this.timers.delete(e)),this.cache.delete(e)}clear(){this.timers.forEach(e=>clearTimeout(e)),this.timers.clear(),this.cache.clear()}size(){return this.cache.size}},g=new class{constructor(){this.cache=p}generateCacheKey(e,s={}){return`${e}:${Object.entries(s).sort(([e],[s])=>e.localeCompare(s)).map(([e,s])=>`${e}:${s}`).join("|")}`}async fetchProducts(s={}){const a=this.generateCacheKey("products",s);if(this.cache.has(a))return this.cache.get(a);try{let t=i(e,"products");s.category&&(t=o(t,c("category","==",s.category))),s.searchQuery&&(t=o(t,c("name",">=",s.searchQuery),c("name","<=",s.searchQuery+"\\uf8ff"))),t=s.lastVisible?o(t,d(s.lastVisible),n(s.pageSize||12)):o(t,n(s.pageSize||12));const r=await m(t),l={products:r.docs.map(e=>({id:e.id,...e.data()})),lastVisible:r.docs[r.docs.length-1],hasMore:r.docs.length===(s.pageSize||12)};return this.cache.set(a,l,12e4),l}catch(t){throw t}}async fetchHeroSlides(){const s="heroes:all";if(this.cache.has(s))return this.cache.get(s);try{const a=o(i(e,"heroes"),h("createdAt","desc")),t=(await m(a)).docs.map(e=>({id:e.id,...e.data()}));return this.cache.set(s,t,6e5),t}catch(a){throw a}}async preloadNextPage(e){if(!e.lastVisible)return;const s={...e,lastVisible:e.lastVisible};setTimeout(()=>{this.fetchProducts(s).catch(console.error)},1e3)}clearCache(){this.cache.clear()}getCacheStats(){return{size:this.cache.size(),entries:Array.from(this.cache.cache.keys())}}},w=(e,s=80)=>e&&e.includes("firebasestorage.googleapis.com")?`${e}?alt=media&q=${s}`:e,D=new class{constructor(){this.cache=new Set,this.loading=new Map}preload(e){if(this.cache.has(e)||this.loading.has(e))return this.loading.get(e)||Promise.resolve();const s=new Promise((s,a)=>{const t=new Image;t.onload=()=>{this.cache.add(e),this.loading.delete(e),s(t)},t.onerror=s=>{this.loading.delete(e),a(s)},t.src=e});return this.loading.set(e,s),s}preloadMultiple(e){return Promise.allSettled(e.map(e=>this.preload(e)))}preloadWithPriority(e,s=3){return new Promise(a=>{const t=[];let r=0,l=0;const i=()=>{if(l>=e.length)return void(r===e.length&&a(t));const s=e[l++];this.preload(s).then(e=>{t.push({status:"fulfilled",value:e})}).catch(e=>{t.push({status:"rejected",reason:e})}).finally(()=>{r++,i()})};for(let o=0;o<Math.min(s,e.length);o++)i()})}isCached(e){return this.cache.has(e)}clearCache(){this.cache.clear(),this.loading.clear()}getCacheSize(){return this.cache.size}},y={women:{webp:"data:image/webp;base64,UklGRkIBAABXRUJQVlA4IDYBAADwBQCdASoAQABAAP7+/P//////kgAiCWlu/KVH8dxlz9WAF0mwN+5DP0cPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPAAA=",fallback:"/images/women-optimized.webp",placeholder:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHZpZXdCb3g9IjAgMCA5NiA5NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjQ4IiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjOWNhM2FmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5Xb21lbjwvdGV4dD4KPC9zdmc+"},men:{webp:"data:image/webp;base64,UklGRkIBAABXRUJQVlA4IDYBAADwBQCdASoAQABAAP7+/P//////kgAiCWlu/KVH8dxlz9WAF0mwN+5DP0cPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPAAA=",fallback:"/images/men-optimized.webp",placeholder:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHZpZXdCb3g9IjAgMCA5NiA5NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjQ4IiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjOWNhM2FmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5NZW48L3RleHQ+Cjwvc3ZnPg=="},kids:{webp:"data:image/webp;base64,UklGRkIBAABXRUJQVlA4IDYBAADwBQCdASoAQABAAP7+/P//////kgAiCWlu/KVH8dxlz9WAF0mwN+5DP0cPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPQw9DD0MPAAA=",fallback:"/images/kids-optimized.webp",placeholder:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHZpZXdCb3g9IjAgMCA5NiA5NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjQ4IiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjOWNhM2FmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5LaWRzPC90ZXh0Pgo8L3N2Zz4="}},b=(e,s={})=>{const{preferWebP:a=!0,width:t=96,height:r=96,quality:l=80}=s,i=y[e];return i?(()=>{try{return document.createElement("canvas").toDataURL("image/webp").indexOf("webp")>-1}catch{return!1}})()&&a?i.webp:i.fallback||i.placeholder:i.placeholder},f=r.lazy(()=>a(()=>import("./HeroSlider-Dx3JsA4_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url)),j=r.lazy(()=>a(()=>import("./ui-DPpDBAq4.js").then(e=>e.l),__vite__mapDeps([2,3]),import.meta.url).then(e=>({default:e.ShoppingCart}))),P=r.lazy(()=>a(()=>import("./ui-DPpDBAq4.js").then(e=>e.l),__vite__mapDeps([2,3]),import.meta.url).then(e=>({default:e.WifiOff}))),N=r.lazy(()=>a(()=>import("./ui-DPpDBAq4.js").then(e=>e.l),__vite__mapDeps([2,3]),import.meta.url).then(e=>({default:e.Heart}))),v=r.lazy(()=>a(()=>import("./ui-DPpDBAq4.js").then(e=>e.l),__vite__mapDeps([2,3]),import.meta.url).then(e=>({default:e.Search}))),M=r.lazy(()=>a(()=>import("./ui-DPpDBAq4.js").then(e=>e.l),__vite__mapDeps([2,3]),import.meta.url).then(e=>({default:e.X}))),Q=r.lazy(()=>a(()=>import("./ui-DPpDBAq4.js").then(e=>e.l),__vite__mapDeps([2,3]),import.meta.url).then(e=>({default:e.Grid}))),I=r.lazy(()=>a(()=>import("./ui-DPpDBAq4.js").then(e=>e.l),__vite__mapDeps([2,3]),import.meta.url).then(e=>({default:e.List})));class A extends t.Component{state={hasError:!1};static getDerivedStateFromError(e){return{hasError:!0}}render(){return this.state.hasError?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 to-red-100",children:s.jsxs("div",{className:"text-center p-6 bg-white rounded-2xl shadow-xl max-w-md mx-auto",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(P,{className:"w-6 h-6 sm:w-8 sm:h-8 text-red-600"})}),s.jsx("h2",{className:"text-xl font-bold text-red-600 mb-3",children:"Something went wrong"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"We're experiencing technical difficulties. Please try again later."}),s.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Refresh Page"})]})}):this.props.children}}const S={products:[],loading:!1,searchQuery:"",favoriteState:[],lastVisible:null,hasMore:!0,page:1,viewMode:"grid"};function E(e,s){switch(s.type){case"SET_PRODUCTS":return{...e,products:s.payload};case"SET_LOADING":return{...e,loading:s.payload};case"SET_SEARCH_QUERY":return{...e,searchQuery:s.payload};case"SET_FAVORITE_STATE":return{...e,favoriteState:Array.isArray(s.payload)?s.payload:[]};case"SET_LAST_VISIBLE":return{...e,lastVisible:s.payload};case"SET_HAS_MORE":return{...e,hasMore:s.payload};case"SET_PAGE":return{...e,page:s.payload};case"SET_VIEW_MODE":return{...e,viewMode:s.payload};case"RESET_PAGINATION":return{...e,page:1,lastVisible:null,hasMore:!0,products:[]};default:return e}}const _=t.memo(({product:e,onAddToCart:a,onAddToFavorites:t,isFav:l})=>{const[i,o]=r.useState(!1),[c,d]=r.useState(!1),n=parseFloat(e.price),m=parseFloat(e.newPrice),h=e.images&&e.images.length>0?e.images[0]:null;return s.jsxs("div",{className:"group bg-white rounded-lg shadow-sm overflow-hidden transition-all duration-300 hover:shadow-md border border-gray-100 flex flex-col h-full",children:[s.jsxs("div",{className:"relative overflow-hidden bg-gray-100 aspect-[1/1]",children:[s.jsx(x,{to:`/product/${e.id}`,"aria-label":`View details for ${e.name}`,children:h?s.jsx(u.LazyLoadImage,{src:w(h,75),alt:e.name,effect:"blur",className:"w-full h-full object-cover transition-opacity duration-300 "+(i?"opacity-100":"opacity-0"),onLoad:()=>o(!0),onError:()=>d(!0),placeholderSrc:w(h,10),threshold:100,loading:"lazy"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-200",children:s.jsx("div",{className:"w-16 h-16 bg-gray-300 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-gray-500 text-xs",children:"No Image"})})})}),!i&&!c&&h&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200 animate-pulse",children:s.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full"})}),c&&s.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-100 p-2",children:[s.jsx(P,{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400 mb-1"}),s.jsx("p",{className:"text-gray-500 text-xs",children:"Image unavailable"})]}),s.jsx("div",{className:"absolute top-2 right-2 flex flex-col space-y-2 z-10",children:s.jsx("button",{onClick:()=>t(e.id),"aria-label":l?"Remove from favorites":"Add to favorites",className:"p-1 sm:p-1.5 max-[450px]:p-1 rounded-full backdrop-blur-sm transition-all duration-300 shadow-sm "+(l?"bg-pink-100 text-pink-600":"bg-white/80 text-gray-600 hover:bg-pink-50 hover:text-pink-600"),children:s.jsx(N,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 max-[450px]:w-3 max-[450px]:h-3 transition-all duration-200 "+(l?"fill-current":"")})})})]}),s.jsxs("div",{className:"p-2 flex flex-col flex-grow",children:[s.jsx("div",{className:"flex justify-between items-start mb-1",children:s.jsx("h3",{className:"font-bold text-sm sm:text-base text-gray-900 line-clamp-1",children:e.name})}),s.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[n>m&&s.jsxs("span",{className:"line-through text-xs text-gray-500",children:["$",n.toFixed(2)]}),s.jsxs("span",{className:"text-sm sm:text-base font-bold text-red-700",children:["$",m.toFixed(2)]}),n>m&&s.jsxs("div",{className:"\r\n      line-through\r\n      bg-pink-100 text-pink-600 \r\n      px-2 py-1 \r\n      rounded-full \r\n      text-xs font-bold \r\n\r\n      sm:px-1.5 sm:py-0.5 sm:text-[11px] \r\n      max-[500px]:px-1 max-[500px]:py-0.5 max-[500px]:text-[10px] \r\n      max-[400px]:px-0.5 max-[400px]:py-0.5 max-[400px]:text-[9px]\r\n    ",children:[Math.round((n-m)/n*100),"%"]})]}),s.jsx("button",{onClick:()=>a(e),className:"p-1 sm:p-1.5 max-[450px]:p-1 bg-red-700 text-white rounded-lg hover:bg-red-800 transition-colors shadow-sm","aria-label":`Add ${e.name} to cart`,children:s.jsx(j,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 max-[450px]:w-3 max-[450px]:h-3"})})]})]})]})},(e,s)=>e.product.id===s.product.id&&e.isFav===s.isFav),T=()=>s.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden animate-pulse border border-gray-100 flex flex-col h-full",children:[s.jsxs("div",{className:"relative overflow-hidden bg-gray-200 aspect-[1/1]",children:[s.jsx("div",{className:"absolute top-2 left-2 bg-gray-300 rounded-full px-1 py-0.5 sm:px-1.5 sm:py-0.5 max-[450px]:px-1 max-[450px]:py-0.5 w-12 h-4 max-[450px]:w-10 max-[450px]:h-3"}),s.jsxs("div",{className:"absolute top-2 right-2 flex flex-col space-y-2 z-10",children:[s.jsx("div",{className:"p-1 sm:p-1.5 max-[450px]:p-1 rounded-full bg-gray-300 w-6 h-6 sm:w-7 sm:h-7 max-[450px]:w-5 max-[450px]:h-5"}),s.jsx("div",{className:"p-1 sm:p-1.5 max-[450px]:p-1 rounded-full bg-gray-300 w-6 h-6 sm:w-7 sm:h-7 max-[450px]:w-5 max-[450px]:h-5"})]})]}),s.jsxs("div",{className:"p-2 flex flex-col flex-grow",children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("div",{className:"h-4 bg-gray-300 rounded w-2/3"}),s.jsx("div",{className:"h-4 bg-gray-300 rounded-full w-12"})]}),s.jsx("div",{className:"h-3 bg-gray-300 rounded w-full mb-1"}),s.jsx("div",{className:"h-3 bg-gray-300 rounded w-5/6 mb-2"}),s.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"h-3 bg-gray-300 rounded w-8"}),s.jsx("div",{className:"h-5 bg-gray-300 rounded w-14"})]}),s.jsx("div",{className:"p-1 sm:p-1.5 max-[450px]:p-1 bg-gray-300 rounded-lg w-6 h-6 sm:w-7 sm:h-7 max-[450px]:w-5 max-[450px]:h-5"})]})]})]}),k=t.memo(({searchQuery:e,setSearchQuery:a,filteredCount:t})=>{const l=r.useCallback((()=>{let e;return function(...s){clearTimeout(e),e=setTimeout(()=>{clearTimeout(e),(e=>{a(e)})(...s)},300)}})(),[a]);return s.jsx("div",{className:"w-full mb-10 mx-auto px-4",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(v,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-400"})}),s.jsx("input",{type:"text",placeholder:"Search products...",defaultValue:e,onChange:e=>l(e.target.value),className:"w-full pl-9 pr-9 py-3 border border-gray-300 rounded-xl bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-red-600 focus:border-red-600 transition-all duration-300 text-sm","aria-label":"Search products"}),e&&s.jsx("button",{onClick:()=>a(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":"Clear search",children:s.jsx(M,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-400 hover:text-gray-600"})})]}),""!==e.trim()&&s.jsxs("div",{className:"mt-2 text-center",children:[s.jsxs("p",{className:"text-gray-700 text-sm",children:["Searching for ",s.jsxs("span",{className:"font-semibold text-red-700",children:['"',e,'"']})]}),s.jsxs("p",{className:"text-gray-600 text-xs",children:["Found ",s.jsx("span",{className:"font-bold",children:t})," result",1!==t?"s":""]})]})]})})}),C=t.memo(()=>{const e=[{name:"men",img:b("men")},{name:"women",img:b("women")},{name:"kids",img:b("kids")}];return r.useEffect(()=>{Object.values(y).forEach(e=>{if(e.webp){const s=document.createElement("link");s.rel="preload",s.as="image",s.href=e.webp,document.head.appendChild(s)}})},[]),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Shop by Category"}),s.jsx("p",{className:"text-gray-600 text-sm max-w-2xl mx-auto",children:"Browse our collections and find the perfect items for you"})]}),s.jsx("div",{className:"flex justify-center gap-4 sm:gap-8 md:gap-16",children:e.map(e=>s.jsxs("div",{className:"flex flex-col items-center group",children:[s.jsxs("button",{onClick:()=>{const s=document.getElementById(`${e.name}-section`);s?.scrollIntoView({behavior:"smooth"})},className:"relative w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-full overflow-hidden transition-all duration-300 group-hover:shadow-xl group-hover:-translate-y-1 border-4 border-white shadow-lg","aria-label":`View ${e.name} products`,children:[s.jsx(u.LazyLoadImage,{src:e.img,alt:`${e.name} category`,effect:"blur",width:96,height:96,className:"w-full h-full object-cover",loading:"eager"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),s.jsx("span",{className:"mt-2 text-sm sm:text-base font-medium text-gray-800 capitalize group-hover:text-red-700 transition-colors",children:e.name})]},e.name))})]})}),W=t.memo(({title:e,count:a})=>s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:e}),s.jsxs("span",{className:"bg-red-100 text-red-800 text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full",children:[a," ",1===a?"item":"items"]})]})),B=t.memo(({onAddToCart:e,onAddToFavorites:a,favorites:t=[]})=>{const[l,i]=r.useReducer(E,S),{products:o,loading:c,searchQuery:d,favoriteState:n,lastVisible:m,hasMore:h,page:x,viewMode:u}=l,p=r.useRef(n);r.useEffect(()=>{p.current=n},[n]),r.useEffect(()=>{const e=(()=>{try{const e=localStorage.getItem("favorites");if(!e)return[];const s=JSON.parse(e);return Array.isArray(s)?s:[]}catch(e){return[]}})();i({type:"SET_FAVORITE_STATE",payload:e})},[]);const y=r.useCallback(async(e=1,s=d)=>{1===e&&(i({type:"SET_LOADING",payload:!0}),i({type:"RESET_PAGINATION"}));try{const a={searchQuery:s.trim(),pageSize:8,lastVisible:e>1?m:null},t=await new Promise(e=>{const s=async()=>{const s=await g.fetchProducts(a);e(s)};window.requestIdleCallback?window.requestIdleCallback(s,{timeout:1e3}):setTimeout(s,0)});if(i(1===e?{type:"SET_PRODUCTS",payload:t.products}:{type:"SET_PRODUCTS",payload:[...o,...t.products]}),i({type:"SET_LAST_VISIBLE",payload:t.lastVisible}),i({type:"SET_HAS_MORE",payload:t.hasMore}),i({type:"SET_PAGE",payload:e}),t.products.length>0){const e=t.products.slice(0,4).map(e=>e.images&&e.images[0]).filter(Boolean).map(e=>w(e,40));window.requestIdleCallback&&window.requestIdleCallback(()=>{D.preloadWithPriority(e,2)})}}catch(a){}finally{i({type:"SET_LOADING",payload:!1})}},[d,m,o]);r.useEffect(()=>{y()},[]),r.useEffect(()=>{d!==l.searchQuery&&y(1,d)},[d]);const b=r.useCallback(()=>{!c&&h&&y(x+1)},[c,h,x,y]),j=r.useCallback(e=>{const s=Array.isArray(p.current)?[...p.current]:"object"==typeof p.current&&null!==p.current?Object.values(p.current):[];let t;if(t=s.includes(e)?s.filter(s=>s!==e):[...s,e],(e=>{try{const s=Array.isArray(e)?e:[];localStorage.setItem("favorites",JSON.stringify(s))}catch(s){}})(t),i({type:"SET_FAVORITE_STATE",payload:t}),a){const s=o.find(s=>s.id===e);s&&a(s)}},[a,o]),N=Array.isArray(n)?n:"object"==typeof n&&null!==n?Object.values(n):[],v=o.filter(e=>"men"===e.category),M=o.filter(e=>"women"===e.category),B=o.filter(e=>"kids"===e.category);return c&&0===o.length?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Our Products"}),s.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto text-sm",children:"Discover our latest collection of premium products"})]}),s.jsx("div",{className:"p-6 grid gap-3 sm:gap-4 md:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 bg-gray-50",children:Array.from({length:4}).map((e,a)=>s.jsx(T,{},a))})]})}):0===o.length?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-6 bg-white rounded-2xl shadow-xl",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(P,{className:"w-6 h-6 sm:w-8 sm:h-8 text-red-600"})}),s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-3",children:"No Products Available"}),s.jsx("p",{className:"text-gray-600 mb-6 text-sm",children:"We couldn't find any products at the moment. Please check back later."}),s.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Refresh Page"})]})}):s.jsx(A,{children:s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[s.jsx(r.Suspense,{fallback:s.jsx("div",{className:"h-64 bg-gray-200 animate-pulse"}),children:s.jsx(f,{})}),s.jsx(C,{}),s.jsx(k,{searchQuery:d,setSearchQuery:e=>i({type:"SET_SEARCH_QUERY",payload:e}),filteredCount:o.length}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 mb-4 hidden sm:flex justify-end",children:s.jsxs("div",{className:"inline-flex rounded-md shadow-sm",role:"group",children:[s.jsx("button",{type:"button",onClick:()=>i({type:"SET_VIEW_MODE",payload:"grid"}),className:"px-3 py-2 text-sm font-medium rounded-l-lg "+("grid"===u?"bg-red-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:s.jsx(Q,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),s.jsx("button",{type:"button",onClick:()=>i({type:"SET_VIEW_MODE",payload:"list"}),className:"px-3 py-2 text-sm font-medium rounded-r-md "+("list"===u?"bg-red-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:s.jsx(I,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})}),v.length>0&&s.jsxs("div",{id:"men-section",className:"max-w-7xl mx-auto px-4 py-4",children:[s.jsx(W,{title:"Men's Collection",count:v.length}),s.jsxs("div",{className:"p-6 grid gap-3 sm:gap-4 md:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:["              ",v.map(a=>s.jsx(_,{product:a,onAddToCart:e,onAddToFavorites:j,isFav:N.includes(a.id)},a.id))]})]}),M.length>0&&s.jsxs("div",{id:"women-section",className:"max-w-7xl mx-auto px-4 py-4",children:[s.jsx(W,{title:"Women's Collection",count:M.length}),s.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:M.map(a=>s.jsx(_,{product:a,onAddToCart:e,onAddToFavorites:j,isFav:N.includes(a.id)},a.id))})]}),B.length>0&&s.jsxs("div",{id:"kids-section",className:"max-w-7xl mx-auto px-4 py-4",children:[s.jsx(W,{title:"Kids' Collection",count:B.length}),s.jsx("div",{className:"grid gap-3 sm:gap-4 md:gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:B.map(a=>s.jsx(_,{product:a,onAddToCart:e,onAddToFavorites:j,isFav:N.includes(a.id)},a.id))})]}),h&&s.jsx("div",{className:"flex justify-center my-8",children:s.jsx("button",{onClick:b,disabled:c,className:"px-6 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all duration-300 shadow-md hover:shadow-lg flex items-center disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:c?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):"Load More Products"})})]})})});export{B as default};
